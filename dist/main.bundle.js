(()=>{"use strict";const e=["#FA6B5D","#F79C53","#EFC95E","#76BD6D","#59AAA4","#9F82C4","#C482BD"];class t{constructor(e){this.render=()=>(this.sphere=document.createElement("div"),this.sphere.className="sphere",this.sphere.style.background=this.color,this.sphere),this.color=e,this.sphere}}function n(e,n,l,d,i){const u=new t(l).render();return u.addEventListener("click",(t=>function(e,t,n,l,d){const i=e.currentTarget;y(l,d),c<2&&(i.classList.contains("seeker")?(g(d.defaultSeeker,l,!1,d),S("seeker"),o=[],c=0):function(e,t,n,o){let r=[];function l(o,r){var l;if(0!==(null===(l=n[e+o])||void 0===l?void 0:l[t+r]))return!1}return r.push(l(-1,0)),r.push(l(1,0)),r.push(l(0,-1)),r.push(l(0,1)),!r.every((e=>!1===e))}(t,n,l)&&(g(d.defaultSeeker,l,!1,d),S("seeker"),o=[t,n],i.classList.add("seeker"),l[t][n]=d.defaultSeeker,r=i.style.background,s(o,0,l,d),c=1)),console.table(l)}(t,e,n,d,i))),u}let o,r,l,d=[];p(3,e);let i,c=0,u=!1;function s(e,t,n,o){function r(r,l){var d;let i=null===(d=n[e[0]+r])||void 0===d?void 0:d[e[1]+l];0===i&&(i+=t,n[e[0]+r][e[1]+l]=i,setTimeout((()=>s([e[0]+r,e[1]+l],t,n,o)),1))}t++,r(-1,0),r(1,0),r(0,-1),r(0,1)}function a(e,t,n){const r=e.currentTarget;1==c&&(l=v(r.id),o!=l&&r.classList.add("waypoint"),function(e,t,n,o){let r=[t];function l(e,t,o,d,i){var c;let u=null===(c=n[e+o])||void 0===c?void 0:c[t+d];r.includes(u)||u===i-1&&(r.push(u),document.getElementById(`${e+o}-${t+d}`).classList.add("path"),l(e+o,t+d,-1,0,i-1),l(e+o,t+d,1,0,i-1),l(e+o,t+d,0,-1,i-1),l(e+o,t+d,0,1,i-1))}l(e[0],e[1],-1,0,t),l(e[0],e[1],1,0,t),l(e[0],e[1],0,-1,t),l(e[0],e[1],0,1,t),i=t===r.length}(l,t[l[0]][l[1]],t))}function h(){u||(S("path"),S("waypoint"))}function f(t,s,E){const L=t.currentTarget;1==c&&(l=v(L.id),o!=l&&L.classList.add("waypoint"),i&&(function(t,o,l,i){const s=document.getElementById(`${t[0]}-${t[1]}`);let v=document.getElementById(`${o[0]}-${o[1]}`);v.replaceWith(v.cloneNode(!1)),v=document.getElementById(`${o[0]}-${o[1]}`),g(i.defaultSeeker,l,!0,i),l[o[0]][o[1]]=i.defaultSphere,u=!0,s.innerHTML="",v.innerHTML="",S("waypoint"),v.append(n(o[0],o[1],r,l,i)),console.table(l),setTimeout((()=>{!function(e,t){u=!1,c=0,S("seeker"),S("path"),g(t.defaultSeeker,e,!0,t),g(t.defaultWaypoint,e,!0,t),document.querySelector("#upcoming").innerHTML="",function(e,t){for(let o=0;o<d.length;o++){let r=[m(t.height),m(t.width)];for(;e[r[0]][r[1]]==t.defaultSphere;)r=[m(t.height),m(t.width)];e[r[0]][r[1]]=t.defaultSphere;const l=document.getElementById(r[0]+"-"+r[1]);l.replaceWith(l.cloneNode(!1)),l.innerHTML="",document.getElementById(r[0]+"-"+r[1]).append(n(r[0],r[1],d[o],e,t))}}(e,t),d=[],y(e,t),function(e,t){for(let n=0;n<e.length;n++)for(let o=0;o<e[n].length;o++)if(0==e[n][o]){const r=document.getElementById(n+"-"+o);r.addEventListener("mouseenter",(t=>a(t,e))),r.addEventListener("mouseleave",h),r.addEventListener("click",(n=>f(n,e,t)))}}(e,t)}(l,i),p(3,e)}),1e3)}(o,l,s,E),c=2))}function p(e,n){const o=document.querySelector("#upcoming");for(let r=0;r<e;r++){const e=n[Math.floor(Math.random()*n.length)],r=new t(e).render();r.classList.add("default"),d.push(e),o.append(r)}console.log(d)}function m(e){return Math.floor(Math.random()*e)}function g(e,t,n,o){for(let r=0;r<t.length;r++)for(let l=0;l<t[r].length;l++)t[r][l]==e&&(e===o.defaultSeeker?t[r][l]=n?0:o.defaultSphere:(t[r][l]=0,document.querySelector(r+"-"+l).innerHTML="0"))}function S(e){document.querySelectorAll("."+e).forEach((t=>t.classList.remove(e.toString())))}function v(e){return e.split("-").map((e=>parseInt(e)))}function y(e,t){for(let n=0;n<e.length;n++)for(let o=0;o<e[n].length;o++)e[n][o]!=t.defaultSeeker&&e[n][o]!=t.defaultWaypoint&&e[n][o]!=t.defaultSphere&&(e[n][o]=0)}const E=document.querySelector("#app"),L={width:9,height:9,sphereAmount:3,defaultSeeker:"S",defaultWaypoint:"W",defaultSphere:"#"},k=function(e,t){let n=[];for(let o=0;o<t;o++){n[o]=[];for(let t=0;t<e;t++)n[o][t]=0}return n}(L.width,L.height);!function(e,t){for(let n=0;n<t.sphereAmount;n++){let n=[m(t.height),m(t.width)];for(;e[n[0]][n[1]]==t.defaultSphere;)n=[m(t.height),m(t.width)];e[n[0]][n[1]]=t.defaultSphere}}(k,L),E.append(function(e,t,o){const r=document.createElement("div");r.className="tileset";for(let l=0;l<t.height;l++)for(let d=0;d<t.width;d++){let i=document.createElement("div");i.id=l+"-"+d,i.classList.add("tile"),e[l][d]==t.defaultSphere?i.append(n(l,d,o[Math.floor(Math.random()*o.length)],e,t)):(i.addEventListener("mouseenter",(t=>a(t,e))),i.addEventListener("mouseleave",h),i.addEventListener("click",(n=>f(n,e,t)))),0!=l&&0==d&&(i.style.clear="both"),r.append(i)}return r}(k,L,e)),console.table(k)})();